var SOCIAL_API_INITIALIZED_MSG="social_api_initialized",SOCIAL_API_INITIALIZATION_FAILED_MSG="social_api_initialization_failed",USER_PROFILE_LOADED_MSG="social_user_profile_loaded",USER_PROFILE_LOADING_FAILED_MSG="social_user_profile_loading_failed",USER_AUTHORIZED_MSG="social_user_authorized",USER_AUTHORIZATION_FAILED_MSG="social_authorization_failed",PRODUCTS_LOADED_MSG="social_products_loaded",PRODUCTS_LOADING_FAILED_MSG="social_products_loading_failed",PRODUCT_PURCHASED_MSG="social_product_purchased",PRODUCT_PURCHASE_FAILED_MSG="social_product_purchase_failed",SHORTCUT_CREATED_MSG="social_shortcut_created",SHORTCUT_CREATION_FAILED_MSG="social_shortcut_creation_failed",ADS_INITIALIZED_MSG="ads_initialized",ADS_INITIALIZE_FAILED_MSG="ads_initialize_failed",REWARDED_AD_LOADED_MSG="rewarded_ad_loaded",REWARDED_AD_SHOWED_MSG="rewarded_ad_showed",REWARDED_AD_SHOW_FAILED_MSG="rewarded_ad_show_failed",INTERSTITIAL_AD_LOADED_MSG="interstitial_ad_loaded",INTERSTITIAL_AD_SHOWED_MSG="interstitial_ad_showed",INTERSTITIAL_AD_SHOW_FAILED_MSG="interstitial_ad_show_failed",DEVICE_DESKTOP="desktop",DEVICE_MOBILE_WEB="mobile_web",DEVICE_UNKNOWN="unknown";function generateUUID(){var d=(new Date).getTime(),d2="undefined"!=typeof performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=16*Math.random();return 0<d?(r=(d+r)%16|0,d=Math.floor(d/16)):(r=(d2+r)%16|0,d2=Math.floor(d2/16)),("x"===c?r:3&r|8).toString(16)})}var socialPlatform={_ysdk:void 0,_player:void 0,_payments:void 0,_can_add_shortcut:void 0,progress:function(progress){console.log("Loading progress:",progress)},preInitialize:function(callback){if("undefined"==typeof YaGames)throw new Error("Unable to resolve YaGames");YaGames.init().then(function(ysdk){console.log("YaGames successfully initialized"),socialPlatform._ysdk=ysdk,callback(),socialPlatform._ysdk.shortcut.canShowPrompt().then(prompt=>{socialPlatform._can_add_shortcut=prompt.canShow})},function(error){console.log("Unable to initialize YaGames:",error),callback()})},initialize:function(){socialPlatform._ysdk?socialPlatform._ysdk.getPlayer({signed:!0,scopes:!0}).then(function(player){player.getMode&&"lite"===player.getMode()?(console.log("Light mode player, ignore it"),JsToDef.send(SOCIAL_API_INITIALIZED_MSG,{auth_fields:{api_type:925}})):(socialPlatform._player=player,JsToDef.send(SOCIAL_API_INITIALIZED_MSG,{auth_fields:{api_type:25,api_uid:player.getUniqueID(),auth_sig:"",session_key:player.signature}}))},function(){JsToDef.send(SOCIAL_API_INITIALIZED_MSG,{auth_fields:{api_type:925}})}):JsToDef.send(SOCIAL_API_INITIALIZATION_FAILED_MSG,{error:"API is not initialized"})},canLogin:function(){return!0},login:function(){socialPlatform._ysdk.auth.openAuthDialog().then(function(){socialPlatform._ysdk.getPlayer({signed:!0,scopes:!0}).then(function(player){player.getMode&&"lite"===player.getMode()?(console.log("Light mode player, ignore it"),JsToDef.send(USER_AUTHORIZATION_FAILED_MSG,{error:"Authentification failed: lite mode"})):(socialPlatform._player=player,JsToDef.send(USER_AUTHORIZED_MSG,{auth_fields:{api_type:25,api_uid:player.getUniqueID(),auth_sig:"",session_key:player.signature}}))}).catch(function(error){JsToDef.send(USER_AUTHORIZATION_FAILED_MSG,{error:"Authentification failed: "+String(error)})})},function(error){JsToDef.send(USER_AUTHORIZATION_FAILED_MSG,{error:"Authentification failed: "+String(error)})})},getDefaultLocale:function(){return socialPlatform._ysdk?.environment?.i18n?.lang},getCountryCode:function(){return"unknown"},getInstallReferrer:function(){},loadUserProfile:function(){var name;socialPlatform._player?(name=socialPlatform._player.getName())?(name=name.split(" "),JsToDef.send(USER_PROFILE_LOADED_MSG,{profile:{first_name:name[0]||"",last_name:name[1]||"",avatar:socialPlatform._player.getPhoto("medium"),gender:0}})):JsToDef.send(USER_PROFILE_LOADING_FAILED_MSG,{error:"No data"}):JsToDef.send(USER_PROFILE_LOADING_FAILED_MSG,{error:"Not authorized user"})},canCreateShortcut:function(){return socialPlatform._can_add_shortcut},createShortcut:function(){socialPlatform._ysdk.shortcut.showPrompt().then(result=>{"accepted"===result.outcome?(console.log("Shortcut successfully created"),JsToDef.send(SHORTCUT_CREATED_MSG)):(console.log("Shortcut failed to create"),JsToDef.send(SHORTCUT_CREATION_FAILED_MSG)),socialPlatform._can_add_shortcut=!1}).catch(function(){console.log("Shortcut failed to create"),JsToDef.send(SHORTCUT_CREATION_FAILED_MSG),socialPlatform._can_add_shortcut=!1})},getStoreName:function(){return"yandex"},loadProducts:function(productIds){socialPlatform._ysdk.getPayments({signed:!0}).then(function(payments){return socialPlatform._payments=payments,Promise.all([payments.getCatalog(),payments.getPurchases()])}).then(function(result){for(var productsData=result[0],purchasesData=result[1],products=[],i=0;i<productsData.length;i++){var purchaseData,productData=productsData[i];0<=productIds.indexOf(productData.id)&&(purchaseData=purchasesData.find(function(data){return data.productID===productData.id}),products.push({id:productData.id,currency_code:productData.priceCurrencyCode,price:productData.priceValue,title:productData.title,description:productData.description,price_string:productData.price,transaction_id:purchaseData&&purchaseData.developerPayload,token:purchaseData&&purchaseData.purchaseToken}))}JsToDef.send(PRODUCTS_LOADED_MSG,{products:products})}).catch(function(error){JsToDef.send(PRODUCTS_LOADING_FAILED_MSG,{error:String(error)})})},buyProduct:function(productId){var transactionId=generateUUID();socialPlatform._payments.purchase({id:productId,developerPayload:transactionId}).then(function(purchase){JsToDef.send(PRODUCT_PURCHASED_MSG,{product_id:productId,transaction_id:purchase.developerPayload,token:purchase.purchaseToken,signature:purchase.signature})},function(error){JsToDef.send(PRODUCT_PURCHASE_FAILED_MSG,{error:String(error)})})},finishTransaction:function(transactionId,token){socialPlatform._payments.consumePurchase(token).then(function(){console.log("Transaction consumed:",transactionId,token)},function(error){console.log("Unable to consume transaction:",error)})},initializeAds:function(){socialPlatform._ysdk?(JsToDef.send(ADS_INITIALIZED_MSG),socialPlatform.preloadInterstitial(),socialPlatform.preloadRewarded()):JsToDef.send(ADS_INITIALIZE_FAILED_MSG)},preloadInterstitial:function(){JsToDef.send(INTERSTITIAL_AD_LOADED_MSG)},showInterstitial:function(){socialPlatform._ysdk.adv.showFullscreenAdv({callbacks:{onClose:function(wasShown){wasShown?(console.log("Interstitial ad successfully watched"),JsToDef.send(INTERSTITIAL_AD_SHOWED_MSG)):(console.log("Interstitial ad failed to watch"),JsToDef.send(INTERSTITIAL_AD_SHOW_FAILED_MSG))},onError:function(error){console.log("Interstitial ad failed to watch:",error)},onOffline:function(){console.log("Interstitial ad went offline")}}})},preloadRewarded:function(){JsToDef.send(REWARDED_AD_LOADED_MSG)},showRewarded:function(){var rewarded=!1;socialPlatform._ysdk.adv.showRewardedVideo({callbacks:{onClose:function(){rewarded?(console.log("Rewarded ad successfully watched"),JsToDef.send(REWARDED_AD_SHOWED_MSG)):(console.log("Rewarded ad failed to watch"),JsToDef.send(REWARDED_AD_SHOW_FAILED_MSG))},onError:function(error){console.log("Rewarded ad faield to watch:",error)},onRewarded:function(){console.log("Rewarded ad confirmed"),rewarded=!0}}})},logEvent:function(){},supportsPageReload:function(){return!0},canShowBanner:function(){return!1},preloadBanner:function(){throw new Error("Not implemented")},isBannerShown:function(){return!1},getBannerTimeout:function(){return 0},showBanner:function(){throw new Error("Not implemented")},hideBanner:function(){throw new Error("Not implemented")},getAdInstallData:function(){},canShare:function(){return!1},share:function(text,paramsString){throw new Error("Not implemented")},markGameReady:function(){socialPlatform._ysdk.features.LoadingAPI?.ready()},markGameplayStarted:function(){socialPlatform._ysdk.features.GameplayAPI.start()},markGameplayStopped:function(){socialPlatform._ysdk.features.GameplayAPI.stop()},onUnpause:function(){},onPause:function(){},hasAdblocker:function(){return!1},getPlatformType:function(){return socialPlatform._ysdk.deviceInfo.isMobile()?DEVICE_MOBILE_WEB:socialPlatform._ysdk.deviceInfo.isDesktop()?DEVICE_DESKTOP:DEVICE_UNKNOWN}};